---
theme: vue-pro
highlight: a11y-dark
---

> å—¨ï¼~ å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯YKèŒ ğŸ· ï¼Œä¸€ä¸ªå¾®ç³»å‰ç«¯ âœ¨ï¼Œçˆ±æ€è€ƒï¼Œçˆ±æ€»ç»“ï¼Œçˆ±è®°å½•ï¼Œçˆ±åˆ†äº« ğŸ¹ï¼Œæ¬¢è¿å…³æ³¨æˆ‘å‘€ ğŸ˜˜ ~ [å¾®ä¿¡å·: `yk2012yk2012`ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼š`ykyk2012`]


ã€Œè¿™æ˜¯æˆ‘å‚ä¸11æœˆæ›´æ–‡æŒ‘æˆ˜çš„ç¬¬26å¤©ï¼Œæ´»åŠ¨è¯¦æƒ…æŸ¥çœ‹ï¼š[2021æœ€åä¸€æ¬¡æ›´æ–‡æŒ‘æˆ˜](https://juejin.cn/post/7023643374569816095/ "https://juejin.cn/post/7023643374569816095/")ã€

> ä»Šå¤©æˆ‘ä»¬ä¸»è¦æ¥å­¦ä¹ Vueä¸­ç»„ä»¶é—´é€šä¿¡çš„æ–¹å¼




# 1. èµ·æ­¥
## 1.1 ç»„ä»¶é—´é€šä¿¡åŸºæœ¬åŸåˆ™
1) ä¸è¦åœ¨å­ç»„ä»¶ä¸­ç›´æ¥ä¿®æ”¹çˆ¶ç»„ä»¶çš„çŠ¶æ€æ•°æ®
2) æ•°æ®åœ¨å“ª, æ›´æ–°æ•°æ®çš„è¡Œä¸º(å‡½æ•°)å°±åº”è¯¥å®šä¹‰åœ¨å“ª

## 1.2 vue ç»„ä»¶é—´é€šä¿¡æ–¹å¼
1) props
2) è‡ªå®šä¹‰äº‹ä»¶
3) æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒ
4) å…¨å±€äº‹ä»¶æ€»çº¿
5) slot
6) vuexã€åé¢å†è¯´ã€‘

# 2. props  çˆ¶ â€”> å­

æ¯”è¾ƒå¸¸ç”¨ï¼Œç”¨äº**çˆ¶ç»„ä»¶**å‘**å­ç»„ä»¶**ä¸­ä¼ é€’æ•°æ®ç”¨

## 2.1 ä½¿ç”¨ç»„ä»¶æ ‡ç­¾æ—¶

å½“æ ‡ç­¾å±æ€§ä¼ é€’è¿›å»

```html
<my-component name='yk' :age='3' :set-name='setName'></my-component>
```

## 2.2 å®šä¹‰MyComponent æ—¶

1) åœ¨ç»„ä»¶å†…å£°æ˜æ‰€æœ‰çš„`props`

2) æ–¹å¼ä¸€: åªæŒ‡å®šåç§°

```javascript
props: ['name', 'age', 'setName']
```

3) æ–¹å¼äºŒ: æŒ‡å®šåç§°å’Œç±»å‹

```javascript
props: {
    name: String,
    age: Number,
    setNmae: Function
}
```

4) æ–¹å¼ä¸‰ã€å®Œæ•´ç‰ˆã€‘: æŒ‡å®šåç§°/ç±»å‹/å¿…è¦æ€§/é»˜è®¤å€¼

```javascript
props: {
    name: {type: String, required: true, default:xxx},
}
```

## 2.3 æ³¨æ„
- æ­¤æ–¹å¼ç”¨äºçˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®
- æ‰€æœ‰æ ‡ç­¾å±æ€§éƒ½ä¼šæˆä¸ºç»„ä»¶å¯¹è±¡çš„å±æ€§, æ¨¡æ¿é¡µé¢å¯ä»¥ç›´æ¥å¼•ç”¨
- é—®é¢˜:
    1. å¦‚æœéœ€è¦å‘éå­åä»£ä¼ é€’æ•°æ®å¿…é¡»å¤šå±‚é€å±‚ä¼ é€’
    2. å…„å¼Ÿç»„ä»¶é—´ä¹Ÿä¸èƒ½ç›´æ¥props é€šä¿¡, å¿…é¡»å€ŸåŠ©çˆ¶ç»„ä»¶æ‰å¯ä»¥






# 3. è‡ªå®šä¹‰äº‹ä»¶  `$emit`  å­ â€”> çˆ¶

## 3.1 ç»‘å®šäº‹ä»¶ç›‘å¬

```javascript
// æ–¹å¼ä¸€: é€šè¿‡v-on ç»‘å®š
@delete_todo="deleteTodo"

// æ–¹å¼äºŒ: é€šè¿‡$on()
this.$refs.xxx.$on('delete_todo', function (todo) {
    this.deleteTodo(todo)
})
```

## 3.2 è§¦å‘äº‹ä»¶

```javascript
// è§¦å‘äº‹ä»¶(åªèƒ½åœ¨çˆ¶ç»„ä»¶ä¸­æ¥æ”¶)
this.$emit(eventName, data)
```
## 3.3 ç¤ºä¾‹
ä¹‹å‰éƒ½æ˜¯è¿™æ ·ç»‘å®šäº‹ä»¶ç›‘å¬ çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶

```html
 <TodoHeader :addTodo="addTodo" /> 
```
å˜æˆ
```html
  <TodoHeader @addTodo="addTodo" />
```
æˆ–è€…è¿™æ ·
```html
<TodoHeader ref="header" />
```
```javascript
mounted(){// å¼‚æ­¥æ‰§è¡Œä»£ç 
    // ç»‘å®šaddTodoäº‹ä»¶ç›‘å¬
    // this.$on('addTodo', this.addTodo) // ç»™Appç»‘å®šç›‘å¬ï¼Œä¸å¯¹çš„
    this.$refs.header.$on('addTodo', this.addTodo)
}
```

å­ç»„ä»¶è§¦å‘äº‹ä»¶
```javascript
this.addTodo(todo); // demo2ä¸­çš„ä»£ç 
```
å˜æˆ
```javascript
this.$emit('addTodo', todo)
```

## 3.4 æ³¨æ„

1) æ­¤æ–¹å¼åªç”¨äºå­ç»„ä»¶å‘çˆ¶ç»„ä»¶å‘é€æ¶ˆæ¯(æ•°æ®)
2) é—®é¢˜: éš”ä»£ç»„ä»¶æˆ–å…„å¼Ÿç»„ä»¶é—´é€šä¿¡æ­¤ç§æ–¹å¼ä¸åˆé€‚



## 3.5 æ€»ç»“

1. é€‚ç”¨äºï¼š<strong style="color:red">å­ç»„ä»¶ ===> çˆ¶ç»„ä»¶</strong>

2. ä½¿ç”¨åœºæ™¯ï¼šAæ˜¯çˆ¶ç»„ä»¶ï¼ŒBæ˜¯å­ç»„ä»¶ï¼ŒBæƒ³ç»™Aä¼ æ•°æ®ï¼Œé‚£ä¹ˆå°±è¦åœ¨Aä¸­ç»™Bç»‘å®šè‡ªå®šä¹‰äº‹ä»¶ï¼ˆäº‹ä»¶çš„å›è°ƒåœ¨Aä¸­ï¼‰ã€‚

3. ç»‘å®šè‡ªå®šä¹‰äº‹ä»¶ï¼š

    1. ç¬¬ä¸€ç§æ–¹å¼ï¼Œåœ¨çˆ¶ç»„ä»¶ä¸­ï¼š```<Demo @yk="test"/>```æˆ– ```<Demo v-on:yk="test"/>```

    2. ç¬¬äºŒç§æ–¹å¼ï¼Œåœ¨çˆ¶ç»„ä»¶ä¸­ï¼š

```js
<Demo ref="demo"/>
......
mounted(){
   this.$refs.xxx.$on('yk',this.test)
}
```

3. è‹¥æƒ³è®©è‡ªå®šä¹‰äº‹ä»¶åªèƒ½è§¦å‘ä¸€æ¬¡ï¼Œå¯ä»¥ä½¿ç”¨```once```ä¿®é¥°ç¬¦ï¼Œæˆ–```$once```æ–¹æ³•ã€‚

4. è§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼š```this.$emit('yk',æ•°æ®)```		

5. è§£ç»‘è‡ªå®šä¹‰äº‹ä»¶```this.$off('yk')```

6. ç»„ä»¶ä¸Šä¹Ÿå¯ä»¥ç»‘å®šåŸç”ŸDOMäº‹ä»¶ï¼Œéœ€è¦ä½¿ç”¨```native```ä¿®é¥°ç¬¦ã€‚

7. æ³¨æ„ï¼šé€šè¿‡```this.$refs.xxx.$on('yk',å›è°ƒ)```ç»‘å®šè‡ªå®šä¹‰äº‹ä»¶æ—¶ï¼Œå›è°ƒè¦ä¹ˆé…ç½®åœ¨methodsä¸­ï¼Œè¦ä¹ˆç”¨ç®­å¤´å‡½æ•°ï¼Œå¦åˆ™thisæŒ‡å‘ä¼šå‡ºé—®é¢˜ï¼


# 4. EventBusäº‹ä»¶æ€»çº¿ `.$emit` `.$on`

å®šä¹‰ä¸€ä¸ªevent-bus.js

```javascript
import Vue from 'vue'
const eventBus = new Vue()
export default eventBus
```

åœ¨éœ€è¦ç”¨åˆ°çš„ç»„ä»¶ä¸­å¯¼å…¥

```javascript
import eventBus from './event-bus'
```
åœ¨äº‹ä»¶ä¸­æ´¾å‘åˆ°eventBusä¸­å¹¶æºå¸¦æ•°æ®
```javascript
eventBus.$emit('addItem', this.title)
```
åœ¨éœ€è¦ç”¨åˆ°æ•°æ®çš„ç»„ä»¶ä¸­æ¥æ”¶æ•°æ®
```javascript
mounted() {
  eventBus.$on('addItem', this.handleAddTitle)
}
```
ä½¿ç”¨æ•°æ®

```javascript
methods: {
    handleAddTitle(title){
        console.log(title)
    }
}
```

è§£ç»‘äº‹ä»¶ç›‘å¬
```javascript
beforeDestroy(){
    eventBus.$off('addItem', this.handleAddTitle)
}
```

# 5. æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒ(PubSubJS åº“)
## 5.1 è®¢é˜…æ¶ˆæ¯

```javascript
PubSub.subscribe('msg', function(msg, data){})
```
## 5.2 å‘å¸ƒæ¶ˆæ¯

```javascript
PubSub.publish('msg', data)
```
## 5.3 ç¤ºä¾‹
è®¢é˜…æ¶ˆæ¯ï¼ˆç»‘å®šäº‹ä»¶ç›‘å¬ï¼‰
```javascript
import PubSub from 'pubsub-js'

export default {
    mounted () {
        // è®¢é˜…æ¶ˆæ¯(deleteTodo)
        PubSub.subscribe('deleteTodo', (msg, index) => {
            this.deleteTodo(index)
        })
    }
}
```
å‘å¸ƒæ¶ˆæ¯ï¼ˆè§¦å‘äº‹ä»¶ï¼‰
```javascript
// this.deleteTodo(this.index)
// å‘å¸ƒæ¶ˆæ¯(deleteTodo)
PubSub.publish('deleteTodo', this.index)
```


## 5.4 æ³¨æ„
1) ä¼˜ç‚¹: æ­¤æ–¹å¼å¯å®ç°ä»»æ„å…³ç³»ç»„ä»¶é—´é€šä¿¡(æ•°æ®)

## 5.5 äº‹ä»¶çš„2 ä¸ªé‡è¦æ“ä½œ
1) ç»‘å®šäº‹ä»¶ç›‘å¬(è®¢é˜…æ¶ˆæ¯)
ç›®æ ‡: æ ‡ç­¾å…ƒç´ `<button>`
äº‹ä»¶å(ç±»å‹): `click/focus`
å›è°ƒå‡½æ•°: `function(event){}`
2) è§¦å‘äº‹ä»¶(å‘å¸ƒæ¶ˆæ¯)
DOM äº‹ä»¶: ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸Šå¯¹åº”çš„ç•Œé¢ä¸Šåšå¯¹åº”çš„æ“ä½œ
è‡ªå®šä¹‰: ç¼–ç æ‰‹åŠ¨è§¦å‘


## 5.6 æ€»ç»“

1.   ä¸€ç§ç»„ä»¶é—´é€šä¿¡çš„æ–¹å¼ï¼Œé€‚ç”¨äº<span style="color:red">ä»»æ„ç»„ä»¶é—´é€šä¿¡</span>ã€‚

2. ä½¿ç”¨æ­¥éª¤ï¼š

   1. å®‰è£…pubsubï¼š```npm i pubsub-js```

   2. å¼•å…¥: ```import pubsub from 'pubsub-js'```

   3. æ¥æ”¶æ•°æ®ï¼šAç»„ä»¶æƒ³æ¥æ”¶æ•°æ®ï¼Œåˆ™åœ¨Aç»„ä»¶ä¸­è®¢é˜…æ¶ˆæ¯ï¼Œè®¢é˜…çš„<span style="color:red">å›è°ƒç•™åœ¨Aç»„ä»¶è‡ªèº«ã€‚</span>

```js
methods(){
  demo(data){......}
}
......
mounted() {
  this.pid = pubsub.subscribe('xxx',this.demo) //è®¢é˜…æ¶ˆæ¯
}
```

   4. æä¾›æ•°æ®ï¼š```pubsub.publish('xxx',æ•°æ®)```

   5. æœ€å¥½åœ¨beforeDestroyé’©å­ä¸­ï¼Œç”¨```PubSub.unsubscribe(pid)```å»<span style="color:red">å–æ¶ˆè®¢é˜…ã€‚</span>




```html
<template>
    <div class="school">
        <h2>å­¦æ ¡åç§°ï¼š{{name}}</h2>
        <h2>å­¦æ ¡åœ°å€ï¼š{{address}}</h2>
    </div>
</template>

<script>
    import pubsub from 'pubsub-js'
    export default {
        name:'School',
        data() {
            return {
                name:'å°šç¡…è°·',
                address:'åŒ—äº¬',
            }
        },
        mounted() {
            // console.log('School',this)
            /* this.$bus.$on('hello',(data)=>{
                console.log('æˆ‘æ˜¯Schoolç»„ä»¶ï¼Œæ”¶åˆ°äº†æ•°æ®',data)
            }) */
            this.pubId = pubsub.subscribe('hello',(msgName,data)=>{
                console.log(this)
                // console.log('æœ‰äººå‘å¸ƒäº†helloæ¶ˆæ¯ï¼Œhelloæ¶ˆæ¯çš„å›è°ƒæ‰§è¡Œäº†',msgName,data)
            })
        },
        beforeDestroy() {
            // this.$bus.$off('hello')
            pubsub.unsubscribe(this.pubId)
        },
    }
</script>

<style scoped>
    .school{
        background-color: skyblue;
        padding: 5px;
    }
</style>
```

```html
<template>
    <div class="student">
        <h2>å­¦ç”Ÿå§“åï¼š{{name}}</h2>
        <h2>å­¦ç”Ÿæ€§åˆ«ï¼š{{sex}}</h2>
        <button @click="sendStudentName">æŠŠå­¦ç”Ÿåç»™Schoolç»„ä»¶</button>
    </div>
</template>

<script>
    import pubsub from 'pubsub-js'
    export default {
        name:'Student',
        data() {
            return {
                name:'å¼ ä¸‰',
                sex:'ç”·',
            }
        },
        mounted() {
            // console.log('Student',this.x)
        },
        methods: {
            sendStudentName(){
                // this.$bus.$emit('hello',this.name)
                pubsub.publish('hello',666)
            }
        },
    }
</script>

<style lang="less" scoped>
    .student{
        background-color: pink;
        padding: 5px;
        margin-top: 30px;
    }
</style>

```



# 6. ç»„ä»¶é—´é€šä¿¡4: slot

## 6.1 ç†è§£
æ­¤æ–¹å¼ç”¨äºçˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’`æ ‡ç­¾æ•°æ®`
## 6.2 å­ç»„ä»¶: Child.vue
```html
<template>
    <div>
        <slot name="xxx">ä¸ç¡®å®šçš„æ ‡ç­¾ç»“æ„1</slot>
        <div>ç»„ä»¶ç¡®å®šçš„æ ‡ç­¾ç»“æ„</div>
        <slot name="yyy">ä¸ç¡®å®šçš„æ ‡ç­¾ç»“æ„2</slot>
    </div>
</template>
```
## 6.3 çˆ¶ç»„ä»¶: Parent.vue

```html
<child>
    <div slot="xxx">xxx å¯¹åº”çš„æ ‡ç­¾ç»“æ„</div>
    <div slot="yyy">yyyy å¯¹åº”çš„æ ‡ç­¾ç»“æ„</div>
</child>
```


å›é¡¾ä¸€ä¸‹æ’æ§½çš„çŸ¥è¯†

### åŒ¿å`slot`
å­ç»„ä»¶å†…éƒ¨å®šä¹‰ä¸€ä¸ªå ä½ç¬¦ï¼Œçˆ¶ç»„ä»¶ä½¿ç”¨æ—¶å¯ä»¥å‘ç»„ä»¶æ ‡ç­¾ä¸­æ’å…¥ä»»ä½•å†…å®¹æ›¿æ¢å­ç»„ä»¶slotä¸­çš„å†…å®¹
###  å…·å`slot`
ç»™slotå…ƒç´ æŒ‡å®šä¸€ä¸ªnameåï¼Œå¯ä»¥åˆ†å‘å¤šä¸ªå†…å®¹

ä¾‹å­
å­ç»„ä»¶æ¨¡æ¿å®šä¹‰

```html
<template>
  <div class="container">
    <div class="header">
      <slot name="header"></slot>
    </div>
    <div class="main">
      <slot></slot>
    </div>
    <div class="footer">
      <slot name="footer"></slot>
    </div>
  </div>
</template>
```
çˆ¶ç»„ä»¶ä½¿ç”¨

```html
<child-component>
  <h2 slot="header">æ ‡é¢˜</h2>
  <p>å†…å®¹</p>
  <p>æ›´å¤š</p>
  <div slot="footer">åº•éƒ¨</div>
</child-component>
```
æœ€åç›¸å½“äº
```html
<div class="container">
  <div class="header">
    <h2>æ ‡é¢˜</h2>
  </div>
  <div class="main">
    <p>å†…å®¹</p>
  	<p>æ›´å¤š</p>
  </div>
  <div class="footer">
    <div>åº•éƒ¨</div>
  </div>
</div>
```
è¿™é‡Œçš„`slot`å·²ç»åºŸå¼ƒäº†ï¼Œç”¨`v-slot`æ›¿ä»£
å¿…é¡»ç”±`template`æ ‡ç­¾åŒ…è£¹ï¼Œä¸”`v-slot`å¯ä»¥ç®€å†™æˆ`#`
```html
<child-component>
  <template v-slot:header>
    <h2>æ ‡é¢˜</h2>
  </template>
  <p>å†…å®¹</p>
  <p>æ›´å¤š</p>
  <template #footer>
    <div slot="footer">åº•éƒ¨</div>
  </template>
</child-component>
```

### ä½œç”¨åŸŸæ’æ§½
å­ç»„ä»¶çš„æ•°æ®é€šè¿‡æ ‡ç­¾ä¼ ç»™çˆ¶ç»„ä»¶
```javascript
<template>
  <h1>
    <slot :user="user">
      {{ user.name }}
    </slot>
  </h1>
</template>

<script>
export default {
  data() {
    return {
      user: {
        name: 'YK',
        age: 18
      }
    }
  }
}
</script>
```

çˆ¶ç»„ä»¶æ¥æ”¶æ•°æ®å¹¶ä½¿ç”¨

```javascript
<current-user>
  <template v-slot:default="slotProps">
    {{ slotProps.user.age }}
  </template>
</current-user>
```
å¯¹è±¡ç»“æ„èµ‹å€¼æ›´ç®€æ´

```javascript
<current-user>
  <template v-slot:default="{ user }">
    {{ user.age }}
  </template>
</current-user>
```



> æœ€åï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„ä¸“æ ï¼Œå’Œ**YKèŒ**åšå¥½æœ‹å‹

