(window.webpackJsonp=window.webpackJsonp||[]).push([[230],{801:function(t,s,a){"use strict";a.r(s);var n=a(7),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"起步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#起步"}},[t._v("#")]),t._v(" 起步")]),t._v(" "),a("p",[t._v("Node.js 是一个基于 Google V8引擎的、跨平台的JavaScript"),a("strong",[t._v("运行环境")]),t._v("（不是一门编程语言）")]),t._v(" "),a("h2",{attrs:{id:"安装与运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装与运行"}},[t._v("#")]),t._v(" 安装与运行")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://nodejs.org/zh-cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://nodejs.org/zh-cn/"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a7a19e23aa504a97bb00b0cbd8530f6f~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("p",[t._v("建议使用LTS版本，一键傻瓜式下载安装")]),t._v(" "),a("p",[t._v("简单写一个Node.js的程序")]),t._v(" "),a("p",[t._v("index.js用来读取文件package.json文件")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" readFile "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./package.json'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("encoding")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf-8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("运行程序")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("node index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js\n")])])]),a("p",[a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/292c5feb49f24a5db3e02157a2a93c6a~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("h2",{attrs:{id:"版本管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#版本管理"}},[t._v("#")]),t._v(" 版本管理")]),t._v(" "),a("p",[t._v("node的版本那么多，\n在同一个设备上如何快速切换Node.js 版本？")]),t._v(" "),a("p",[t._v("可以使用版本管理工具")]),t._v(" "),a("ul",[a("li",[t._v("n: 一个npm 全局的开源包，是依赖npm 来全局安装、使用的")]),t._v(" "),a("li",[t._v("fnm: 快速简单，兼容性支持 .node-version和.nvmrc文件")]),t._v(" "),a("li",[t._v("nvm: 独立的软件包，Node Version Manager")])]),t._v(" "),a("p",[t._v("nvm用的比较多（是macOS平台的软件）\nWindows可以下载"),a("a",{attrs:{href:"https://github.com/coreybutler/nvm-windows",target:"_blank",rel:"noopener noreferrer"}},[t._v("nvm-windows"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("详细教程可见"),a("a",{attrs:{href:"https://www.runoob.com/w3cnote/nvm-manager-node-versions.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.runoob.com/w3cnote/nvm-manager-node-versions.html"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"特点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特点"}},[t._v("#")]),t._v(" 特点")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/edd08dd7439341c7bedbf8b8b8267342~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("h3",{attrs:{id:"异步i-o"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#异步i-o"}},[t._v("#")]),t._v(" 异步I/O")]),t._v(" "),a("p",[t._v("当Node.js执行I/O操作时，会在响应返回并恢复操作，而不是阻塞线程并浪费CPU（循环等待）")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/197809289b304eb8a361f7eb1cdd4733~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("p",[t._v("这里的I/O不仅指文件的读写，也包括对网络的请求，对数据库的操作等")]),t._v(" "),a("p",[a("strong",[t._v("代码编写顺序与执行顺序无关")]),t._v("，看下面这例子")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" readFile "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./node基础/package.json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("encoding")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"utf-8"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'我是在最下面编写的代码'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/012107c405404058bc90b4fd2926e62b~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("h3",{attrs:{id:"单线程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单线程"}},[t._v("#")]),t._v(" 单线程")]),t._v(" "),a("p",[t._v("Node.js 保持了JavaScript 在浏览器中单线程的特点")]),t._v(" "),a("p",[t._v("优点：")]),t._v(" "),a("ul",[a("li",[t._v("不用处处在意状态同步问题，不会发生死锁")]),t._v(" "),a("li",[t._v("没有线程上下文切换带来的性能开销")])]),t._v(" "),a("p",[t._v("缺点：(解决方案会在下一篇博文中说明)")]),t._v(" "),a("ul",[a("li",[t._v("无法利用多核CPU")]),t._v(" "),a("li",[t._v("错误会引起整个应用退出，健壮性不足")]),t._v(" "),a("li",[t._v("大量计算占用导致CPU，无法继续执")])]),t._v(" "),a("h4",{attrs:{id:"多进程的浏览器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多进程的浏览器"}},[t._v("#")]),t._v(" 多进程的浏览器")]),t._v(" "),a("p",[t._v("浏览器是"),a("strong",[t._v("多进程")]),t._v("，JS引擎"),a("strong",[t._v("单线程")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Browser 进程：浏览器主进程，只有一个")])]),t._v(" "),a("li",[a("p",[t._v("插件进程：插件使用时才创建")])]),t._v(" "),a("li",[a("p",[t._v("GPU 进程：最多一个用于3D 绘制")])]),t._v(" "),a("li",[a("p",[t._v("渲染进程：页面渲染、JS执行、事件处理")]),t._v(" "),a("ul",[a("li",[t._v("GUI 渲染线程")]),t._v(" "),a("li",[t._v("JS 引擎线程 （V8）")]),t._v(" "),a("li",[t._v("事件触发线程")]),t._v(" "),a("li",[t._v("定时器触发线程")]),t._v(" "),a("li",[t._v("异步请求线程")])])])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ab566938d7254575a6be5a225161df63~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("h3",{attrs:{id:"跨平台"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#跨平台"}},[t._v("#")]),t._v(" 跨平台")]),t._v(" "),a("p",[t._v("兼容 Windows 和 *nix 平台，主要得益于在操作系统与  Node 上层模块系统之间构建了一层平台架构")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/43173c55494d496ea4571f4d32ce1f3f~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("p",[t._v("底层都是C/C++写的，应用层才是JavaScript写的")]),t._v(" "),a("h2",{attrs:{id:"应用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用场景"}},[t._v("#")]),t._v(" 应用场景")]),t._v(" "),a("p",[t._v("Node.js在大部分领域都占有一席之地，尤其是"),a("strong",[t._v("I/O密集")]),t._v("型的任务（而非"),a("strong",[t._v("计算密集")]),t._v("型任务）")]),t._v(" "),a("ul",[a("li",[t._v("Web应用：Express / Koa")]),t._v(" "),a("li",[t._v("前端构建：Webpack")]),t._v(" "),a("li",[t._v("GUI 客户端软件：VSCode / 网易云音乐")]),t._v(" "),a("li",[t._v("其它：实时通讯、爬虫、CLI 等...")])]),t._v(" "),a("h1",{attrs:{id:"模块化机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模块化机制"}},[t._v("#")]),t._v(" 模块化机制")]),t._v(" "),a("ol",[a("li",[t._v("What 何为模块化？")])]),t._v(" "),a("p",[t._v("根据功能或业务将一个大程序拆分成互相依赖的小文件，再用简单的方式拼装起来")]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Why 为什么模块化？无模块化问题")])]),t._v(" "),a("ul",[a("li",[t._v("所有 "),a("code",[t._v("script")]),t._v(" 标签必须保证顺序正确，否则会依赖报错")]),t._v(" "),a("li",[t._v("全局变量存在命名冲突，占用内存无法被回收")]),t._v(" "),a("li",[a("code",[t._v("IIFE")]),t._v("/"),a("code",[t._v("namespace")]),t._v(" 会导致代码可读性低等诸多问题")])]),t._v(" "),a("h2",{attrs:{id:"commonjs-规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#commonjs-规范"}},[t._v("#")]),t._v(" CommonJS 规范")]),t._v(" "),a("p",[t._v("Node.js 支持CommonJS 模块规范，采用"),a("strong",[t._v("同步机制")]),t._v("加载模块")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6e8575f96b834e53a67ceb0e3c94571d~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("p",[t._v("greeting.js导出模块")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" prefix "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("sayHi")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("prefix"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(" world")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  sayHi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("index.js导入模块")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" sayHi "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./greeting"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sayHi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9135c0d98e9041d083cea1a744c4c5df~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("h3",{attrs:{id:"机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#机制"}},[t._v("#")]),t._v(" 机制")]),t._v(" "),a("p",[t._v("我们来研究一下模块化的机制")]),t._v(" "),a("p",[t._v("导出模块的时候不仅可以这样")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  sayHi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("也可以这样")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sayHi "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sayHi\n")])])]),a("p",[t._v("为什么可以这样呢？\n在node中exports和module.exports指向的是同一块内存引用")]),t._v(" "),a("p",[a("code",[t._v("exports = module.exports = {}")])]),t._v(" "),a("p",[t._v("CommonJS 中 "),a("code",[t._v("exports")]),t._v("、"),a("code",[t._v("require")]),t._v("、"),a("code",[t._v("module")]),t._v("、"),a("code",[t._v("__filename")]),t._v("、"),a("code",[t._v("__dirname")]),t._v(" 变量 到底是什么")]),t._v(" "),a("p",[t._v("我们在暴露我们的模块的时候node会在外面包一层函数，会注入一些模块变量，所以我们可以在模块中直接使用")]),t._v(" "),a("p",[t._v("我们将刚刚的sayHi函数改成一个箭头函数，输出arguments（因为箭头函数没有argumengts，所以会向外查找）")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("sayHi")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nexports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sayHi "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sayHi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e058b4d5a87f436787c7502d0b649b7a~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("p",[t._v("这五个参数分别对应着"),a("code",[t._v("exports")]),t._v("、"),a("code",[t._v("require")]),t._v("、"),a("code",[t._v("module")]),t._v("、"),a("code",[t._v("__filename")]),t._v("、"),a("code",[t._v("__dirname")])]),t._v(" "),a("p",[t._v("所以说Node在外面包裹的一个函数就是这样就是这样")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("__filename"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("__dirname")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" m "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    moudule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("m "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"加载方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#加载方式"}},[t._v("#")]),t._v(" 加载方式")]),t._v(" "),a("ol",[a("li",[t._v("加载内置模块")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("加载相对、绝对路径的文件模块")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 绝对")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/User/.../file.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 相对")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./file.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("加载npm包")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lodash'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"npm-包查找原则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-包查找原则"}},[t._v("#")]),t._v(" npm 包查找原则")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lodash'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/80b5a5a9dd444c83bb14d758adba87da~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("ol",[a("li",[t._v("当前目录 node_modules")]),t._v(" "),a("li",[t._v("如果没有，父级目录的 node_modules")]),t._v(" "),a("li",[t._v("如果没有，沿着路径向上递归，直到根目录下 node_modules")]),t._v(" "),a("li",[t._v("找到之后会加载package.json main 指向的文件，如果没有package.json 则依次查找index.js、index.json、index.node")])]),t._v(" "),a("h3",{attrs:{id:"npm-缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-缓存"}},[t._v("#")]),t._v(" npm 缓存")]),t._v(" "),a("p",[t._v("require.cache 中缓存着加载过的模块，缓存的原因：同步加载")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("文件模块查找耗时，如果每次require 都需要重新遍历查找，性能会比较差；")])]),t._v(" "),a("li",[a("p",[t._v("在实际开发中，模块可能包含副作用代码")])])]),t._v(" "),a("p",[t._v("有缓存")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mod1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./foo"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mod2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./foo"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mod1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" mod2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n")])])]),a("p",[t._v("无缓存")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("requireUnChched")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("module")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delete")]),t._v(" require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mod3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("requireUnChched")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./foo"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mod1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" mod3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// false")]),t._v("\n")])])]),a("h2",{attrs:{id:"其他模块化规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他模块化规范"}},[t._v("#")]),t._v(" 其他模块化规范")]),t._v(" "),a("ul",[a("li",[t._v("AMD 是RequireJS 在推广过程中规范化产出，"),a("strong",[t._v("异步")]),t._v("加载，推崇依赖前置；")]),t._v(" "),a("li",[t._v("CMD 是SeaJS 在推广过程中规范化产出，"),a("strong",[t._v("异步")]),t._v("加载，推崇就近依赖；")]),t._v(" "),a("li",[t._v("UMD (Universal Module Definition) 规范，兼容AMD 和CommonJS 模式")]),t._v(" "),a("li",[t._v("ES Modules (ESM)，语言层面的模块化规范，与环境无关，可借助babel 编译")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5d37f1fa1aba488fb4ecb11b60e413b8~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d06b519a984a4554933422e296f448c7~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("h2",{attrs:{id:"es-modules-esm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#es-modules-esm"}},[t._v("#")]),t._v(" ES Modules (ESM)")]),t._v(" "),a("ul",[a("li",[t._v("ESM 是在ES6 "),a("strong",[t._v("语言层面")]),t._v("提出的一种模块化标准；")]),t._v(" "),a("li",[t._v("ESM中主要有"),a("code",[t._v("import")]),t._v("、"),a("code",[t._v("export")]),t._v("两个关键词，不能"),a("code",[t._v("console")]),t._v("打印两个关键词")]),t._v(" "),a("li",[t._v("可以实现Tree Shaking")])]),t._v(" "),a("p",[a("strong",[t._v("在node环境中如何使用ESM呢？将文件名后缀改成"),a("code",[t._v(".mjs")]),t._v("即可")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c0380b47e99f436fbf8ca636d644e10c~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("p",[t._v("不想改文件名后缀，也可以在项目的package.json中加一个"),a("code",[t._v("type=module *.js")])]),t._v(" "),a("p",[t._v("还可以使用babel编译转成ES5后使用（浏览器、node）")]),t._v(" "),a("h2",{attrs:{id:"commonjs-vs-esm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#commonjs-vs-esm"}},[t._v("#")]),t._v(" CommonJS VS ESM")]),t._v(" "),a("ul",[a("li",[t._v("CommonJS 模块输出的是一个值的"),a("strong",[t._v("拷贝")]),t._v("；ESM 模块输出的是值的"),a("strong",[t._v("引用")])]),t._v(" "),a("li",[t._v("CommonJS 模块是"),a("strong",[t._v("运行时")]),t._v("加载；ESM 模块是"),a("strong",[t._v("编译时")]),t._v("输出(提前加载)")]),t._v(" "),a("li",[t._v("可以混用，但是不建议( import commonjs || import 中require)")])]),t._v(" "),a("p",[t._v("同样的代码在使用不同的模块化机制输出可能不用，我们看下面的例子")]),t._v(" "),a("h4",{attrs:{id:"commonjs-值的拷贝"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#commonjs-值的拷贝"}},[t._v("#")]),t._v(" CommonJS：值的"),a("strong",[t._v("拷贝")])]),t._v(" "),a("p",[t._v("lib.js")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" counter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addCounter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  counter"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  addCounter\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("main.js")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addCounter "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./lib"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addCounter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\n")])])]),a("h4",{attrs:{id:"esm-值的引用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#esm-值的引用"}},[t._v("#")]),t._v(" ESM：值的"),a("strong",[t._v("引用")])]),t._v(" "),a("p",[t._v("lib.mjs")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" counter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addCounter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  counter"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("mian.mjs")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addCounter "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./lib.mjs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addCounter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4")]),t._v("\n")])])]),a("p",[t._v("如果上面的counter定义为一个对象，比如")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" countet "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("number")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("此时，两种模块化的结果就是一样的")]),t._v(" "),a("h2",{attrs:{id:"常用模块介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用模块介绍"}},[t._v("#")]),t._v(" 常用模块介绍")]),t._v(" "),a("p",[t._v("更多内容请见官网 "),a("a",{attrs:{href:"https://nodejs.org/en/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://nodejs.org/en/"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("文件操作模块\n"),a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e7488af522e4d7babf79da914a48ce1~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("p",[t._v("路径模块\n"),a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e200e832aa134a23ac7dc3e374083684~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("p",[t._v("os模块\n"),a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/09e745c390b2400a996636ee3656209f~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("h1",{attrs:{id:"包管理机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#包管理机制"}},[t._v("#")]),t._v(" 包管理机制")]),t._v(" "),a("h2",{attrs:{id:"npm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm"}},[t._v("#")]),t._v(" npm")]),t._v(" "),a("p",[t._v("NPM 是Node.js 中的包管理器，提供了安装、删除等其它命令来管理包")]),t._v(" "),a("h2",{attrs:{id:"常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[t._v("#")]),t._v(" 常用命令")]),t._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("npm init\nnpm config\nnpm run "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[cmd]")]),t._v("\nnpm install "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[pkg]")]),t._v("\nnpm uninstall "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[pkg]")]),t._v("\nnpm update "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[pkg]")]),t._v("\nnpm info "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("[pkg]")]),t._v("\nnpm publish\n")])])]),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6fb9f7d8b07b45b2b567a724bd90b37e~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("h2",{attrs:{id:"package-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#package-json"}},[t._v("#")]),t._v(" package.json")]),t._v(" "),a("ul",[a("li",[t._v("name 包名称")]),t._v(" "),a("li",[t._v("version 版本号")]),t._v(" "),a("li",[t._v("main 入口文件")]),t._v(" "),a("li",[t._v("scripts 执行脚本")]),t._v(" "),a("li",[t._v("dependencies 线上依赖")]),t._v(" "),a("li",[t._v("devDependencies 开发依赖")]),t._v(" "),a("li",[t._v("repository 代码托管地址")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/318fc35cda2b42b8ae7f49e9db8f0c38~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("p",[t._v("更多 "),a("a",{attrs:{href:"https://docs.npmjs.com/cli/v7/configuring-npm/package-json",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.npmjs.com/cli/v7/configuring-npm/package-json"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"版本命名规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#版本命名规范"}},[t._v("#")]),t._v(" 版本命名规范")]),t._v(" "),a("ul",[a("li",[t._v("1.0.0 Must match version exactly")]),t._v(" "),a("li",[t._v(">1.0.0 Must be greater than version")]),t._v(" "),a("li",[t._v(">=1.0.0 etc")]),t._v(" "),a("li",[t._v('~1.2.0 "Approximately equivalent to version" See '),a("a",{attrs:{href:"https://github.com/npm/node-semver",target:"_blank",rel:"noopener noreferrer"}},[t._v("semver"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v('^1.2.0 "Compagble with version" See '),a("a",{attrs:{href:"https://github.com/npm/node-semver",target:"_blank",rel:"noopener noreferrer"}},[t._v("semver"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("1.2.x 1.2.0, 1.2.1, etc., but not 1.3.0")]),t._v(" "),a("li",[t._v("* Matches any version")])]),t._v(" "),a("p",[t._v("npm semver check "),a("a",{attrs:{href:"https://semver.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://semver.npmjs.com/ "),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"第三方依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三方依赖"}},[t._v("#")]),t._v(" 第三方依赖")]),t._v(" "),a("ul",[a("li",[t._v("hip://... See 'URLs as Dependencies' below")]),t._v(" "),a("li",[t._v("git... See 'Git URLs as Dependencies' below")]),t._v(" "),a("li",[t._v("user/repo See 'GitHub URLs' below")]),t._v(" "),a("li",[t._v("path/path/path See "),a("a",{attrs:{href:"https://github.com/npm/node-semver",target:"_blank",rel:"noopener noreferrer"}},[t._v("Local Paths"),a("OutboundLink")],1),t._v(" below")])]),t._v(" "),a("h2",{attrs:{id:"依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#依赖"}},[t._v("#")]),t._v(" 依赖")]),t._v(" "),a("ul",[a("li",[t._v("dependencies 业务依赖，应用发布后正常执行所需要的包")]),t._v(" "),a("li",[t._v("devDependencies 开发依赖，只用于开发环境")]),t._v(" "),a("li",[t._v("peerDependencies 同等依赖，比如一个webpack 插件依赖特定版本的webpack")]),t._v(" "),a("li",[t._v("bundledDependencies 打包依赖(npm run pack)，必须已经在devDep 或者dep声明过")]),t._v(" "),a("li",[t._v("optionalDependencies 可选依赖")])]),t._v(" "),a("h2",{attrs:{id:"私有npm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#私有npm"}},[t._v("#")]),t._v(" 私有npm")]),t._v(" "),a("p",[t._v("如果不想公开一些包，可以用私有npm")]),t._v(" "),a("ul",[a("li",[t._v("镜像公司内部私有npm")]),t._v(" "),a("li",[t._v("镜像设置 "),a("code",[t._v("npm config set registry=hips://bnpm.byted.org")])])]),t._v(" "),a("h2",{attrs:{id:"其他"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),a("p",[t._v("早期的包管理机制问题比较多")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/81c25bca05554f77a18d688bac4463c4~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),a("p",[t._v("旧包管理机制的一些特性")]),t._v(" "),a("ul",[a("li",[t._v("并行安装")]),t._v(" "),a("li",[t._v("扁平管理")]),t._v(" "),a("li",[t._v("锁文件(lockfile)")]),t._v(" "),a("li",[t._v("缓存优化")])]),t._v(" "),a("p",[t._v("新的解决方案")]),t._v(" "),a("ul",[a("li",[t._v("npm7 | yarn => lock/扁平/缓存...")]),t._v(" "),a("li",[t._v("pnpm => monorepo/硬、符号链接/安全性高...")])]),t._v(" "),a("h1",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),a("ul",[a("li",[t._v("字节跳动青训营PPT + 视频")]),t._v(" "),a("li",[t._v("《深入浅出Node.js》")]),t._v(" "),a("li",[t._v("Node中文官网 "),a("a",{attrs:{href:"https://nodejs.org/zh-cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://nodejs.org/zh-cn/"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.runoob.com/w3cnote/nvm-manager-node-versions.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("菜鸟教程nvm"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);