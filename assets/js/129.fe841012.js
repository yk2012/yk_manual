(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{696:function(t,s,a){"use strict";a.r(s);var n=a(7),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("blockquote",[a("p",[t._v("今天来学习一下React组件的生命周，了解新旧版本React中生命周期的三个阶段，最后我们再来简单谈谈虚拟DOM和diff算法")])]),t._v(" "),a("h1",{attrs:{id:"_1-组件的生命周期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-组件的生命周期"}},[t._v("#")]),t._v(" 1. 组件的生命周期")]),t._v(" "),a("h2",{attrs:{id:"_1-1-理解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-理解"}},[t._v("#")]),t._v(" 1.1 理解")]),t._v(" "),a("ol",[a("li",[t._v("组件从创建到死亡它会经历一些特定的阶段。")]),t._v(" "),a("li",[t._v("React组件中包含一系列勾子函数(生命周期回调函数), 会在特定的时刻调用。")]),t._v(" "),a("li",[t._v("我们在定义组件时，会在特定的生命周期回调函数中，做特定的工作。")])]),t._v(" "),a("h2",{attrs:{id:"_1-2-引入案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-引入案例"}},[t._v("#")]),t._v(" 1.2 引入案例")]),t._v(" "),a("p",[t._v("需求:定义组件实现以下功能：")]),t._v(" "),a("ol",[a("li",[t._v("让指定的文本做显示 / 隐藏的渐变动画")]),t._v(" "),a("li",[t._v("从完全可见，到彻底消失，耗时2S")]),t._v(" "),a("li",[t._v("点击“不活了”按钮从界面中卸载组件")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建组件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//生命周期回调函数 <=> 生命周期钩子函数 <=> 生命周期函数 <=> 生命周期钩子")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Life")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Component")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("opacity")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("death")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//卸载组件")]),t._v("\n    ReactDOM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unmountComponentAtNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//组件挂载完毕")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentDidMount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'componentDidMount'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setInterval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获取原状态")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("opacity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//减小 0.1")]),t._v("\n      opacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("opacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" opacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//设置新的透明度")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("opacity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//组件将要卸载")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentWillUnmount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//清除定时器")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("clearInterval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//初始化渲染、状态更新之后")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'render'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h2 style"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("opacity")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("opacity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("React学不会怎么办？"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("death"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("不活了"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//渲染组件")]),t._v("\nReactDOM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Life"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fc4090cc0a5f44248e534fec82ab82d2~tplv-k3u1fbpfcp-zoom-1.image",alt:"在这里插入图片描述"}})]),t._v(" "),a("h2",{attrs:{id:"_1-3-生命周期的三个阶段-旧"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-生命周期的三个阶段-旧"}},[t._v("#")]),t._v(" 1.3 生命周期的三个阶段（旧）")]),t._v(" "),a("p",[t._v("v16.8.4")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/896e2a2a89f642129503d283b41876d3~tplv-k3u1fbpfcp-zoom-1.image",alt:"在这里插入图片描述"}})]),t._v(" "),a("h3",{attrs:{id:"_1-3-1-初始化阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-初始化阶段"}},[t._v("#")]),t._v(" 1.3.1 初始化阶段")]),t._v(" "),a("p",[t._v("由"),a("code",[t._v("ReactDOM.render()")]),t._v("触发---初次渲染")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("constructor()")]),t._v(" —— 类组件中的构造函数")]),t._v(" "),a("li",[a("code",[t._v("componentWillMount()")]),t._v(" —— 组件将要挂载 【即将废弃】")]),t._v(" "),a("li",[a("code",[t._v("render()")]),t._v("  —— 挂载组件")]),t._v(" "),a("li",[a("code",[t._v("componentDidMount()")]),t._v(" —— 组件挂载完成 比较==常用==\n一般在这个钩子中做一些初始化的事，例如：开启定时器、发送网络请求、订阅消息")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Count")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Component")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 构造器")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'constructor'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Count---constructor'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//初始化状态")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("count")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("add")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("count")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" count"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//组件将要挂载的钩子")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentWillMount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'componentWillMount'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Count---componentWillMount'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'render'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Count---render'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("当前计数值："),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("点我"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//组件挂载完毕的钩子")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentDidMount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'componentDidMount'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Count---componentDidMount'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nReactDOM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Count"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7505801778224e368ee9f40edf2d2642~tplv-k3u1fbpfcp-zoom-1.image",alt:"在这里插入图片描述"}})]),t._v(" "),a("h3",{attrs:{id:"_1-3-2-更新阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-更新阶段"}},[t._v("#")]),t._v(" 1.3.2 更新阶段")]),t._v(" "),a("p",[t._v("【第一种情况】父组件重新"),a("code",[t._v("render")]),t._v("触发")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("componentWillReceiveProps()")]),t._v(" —— 接收属性参数（非首次）【即将废弃】")])]),t._v(" "),a("p",[t._v("然后调用下面的钩子函数")]),t._v(" "),a("p",[t._v("【第二种情况】由组件内部"),a("code",[t._v("this.setSate()")])]),t._v(" "),a("ol",[a("li",[a("code",[t._v("shouldComponentUpdate()")]),t._v(" —— 组件是否应该被更新（默认返回"),a("code",[t._v("true")]),t._v("）")])]),t._v(" "),a("p",[t._v("然后调用下面的钩子函数")]),t._v(" "),a("p",[t._v("【第三种情况】强制更新 "),a("code",[t._v("forceUpdate()")])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("code",[t._v("componentWillUpdate()")]),t._v(" ——组件将要更新 【即将废弃】")]),t._v(" "),a("li",[a("code",[t._v("render()")]),t._v(" —— 组件更新")]),t._v(" "),a("li",[a("code",[t._v("componentDidUpdate()")]),t._v(" —— 组件完成更新")])]),t._v(" "),a("h3",{attrs:{id:"_1-3-3-卸载组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-卸载组件"}},[t._v("#")]),t._v(" 1.3.3 卸载组件")]),t._v(" "),a("p",[t._v("由"),a("code",[t._v("ReactDOM.unmountComponentAtNode()")]),t._v("触发")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("componentWillUnmount()")]),t._v(" —— 组件即将卸载")])]),t._v(" "),a("h2",{attrs:{id:"_1-4-生命周期的三个阶段-新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-生命周期的三个阶段-新"}},[t._v("#")]),t._v(" 1.4 生命周期的三个阶段（新）")]),t._v(" "),a("p",[t._v("v17.0.1")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3bceabc916b74ff9b9a2f4552fd9b530~tplv-k3u1fbpfcp-zoom-1.image",alt:"在这里插入图片描述"}})]),t._v(" "),a("h3",{attrs:{id:"_1-初始化阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-初始化阶段"}},[t._v("#")]),t._v(" 1. 初始化阶段")]),t._v(" "),a("p",[t._v("由"),a("code",[t._v("ReactDOM.render()")]),t._v("触发 —— 初次渲染")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("constructor()")]),t._v(" —— 类组件中的构造函数")]),t._v(" "),a("li",[a("code",[t._v("static getDerivedStateFromProps(props, state)")]),t._v(" 从props得到一个派生的状态【新增】")]),t._v(" "),a("li",[a("code",[t._v("render()")]),t._v(" —— 挂载组件")]),t._v(" "),a("li",[a("code",[t._v("componentDidMount()")]),t._v(" —— 组件挂载完成 比较常用")])]),t._v(" "),a("h3",{attrs:{id:"_2-更新阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-更新阶段"}},[t._v("#")]),t._v(" 2. 更新阶段")]),t._v(" "),a("p",[t._v("由组件内部"),a("code",[t._v("this.setSate()")]),t._v("或父组件重新"),a("code",[t._v("render")]),t._v("触发或强制更新"),a("code",[t._v("forceUpdate()")])]),t._v(" "),a("ol",[a("li",[a("code",[t._v("getDerivedStateFromProps()")]),t._v(" —— 从props得到一个派生的状态  【新增】")]),t._v(" "),a("li",[a("code",[t._v("shouldComponentUpdate()")]),t._v(" —— 组件是否应该被更新（默认返回"),a("code",[t._v("true")]),t._v("）")]),t._v(" "),a("li",[a("code",[t._v("render()")]),t._v(" —— 挂载组件")]),t._v(" "),a("li",[a("code",[t._v("getSnapshotBeforeUpdate()")]),t._v(" —— 在更新之前获取快照【新增】")]),t._v(" "),a("li",[a("code",[t._v("componentDidUpdate(prevProps, prevState, snapshotValue)")]),t._v(" —— 组件完成更新")])]),t._v(" "),a("h3",{attrs:{id:"_3-卸载组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-卸载组件"}},[t._v("#")]),t._v(" 3. 卸载组件")]),t._v(" "),a("p",[t._v("由"),a("code",[t._v("ReactDOM.unmountComponentAtNode()")]),t._v("触发")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("componentWillUnmount()")]),t._v(" —— 组件即将卸载")])]),t._v(" "),a("h2",{attrs:{id:"_1-5-重要的勾子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-重要的勾子"}},[t._v("#")]),t._v(" 1.5 重要的勾子")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("render")]),t._v("：初始化渲染或更新渲染调用")]),t._v(" "),a("li",[a("code",[t._v("componentDidMount")]),t._v("：开启监听, 发送ajax请求")]),t._v(" "),a("li",[a("code",[t._v("componentWillUnmount")]),t._v("：做一些收尾工作, 如: 清理定时器")])]),t._v(" "),a("h2",{attrs:{id:"_1-6-即将废弃的勾子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-即将废弃的勾子"}},[t._v("#")]),t._v(" 1.6 即将废弃的勾子")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("componentWillMount")])]),t._v(" "),a("li",[a("code",[t._v("componentWillReceiveProps")])]),t._v(" "),a("li",[a("code",[t._v("componentWillUpdate")])])]),t._v(" "),a("p",[t._v("现在使用会出现警告，下一个大版本需要加上"),a("code",[t._v("UNSAFE_")]),t._v("前缀才能使用，以后可能会被彻底废弃，不建议使用。")]),t._v(" "),a("h1",{attrs:{id:"_2-虚拟dom与dom-diffing算法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-虚拟dom与dom-diffing算法"}},[t._v("#")]),t._v(" 2. 虚拟DOM与DOM Diffing算法")]),t._v(" "),a("h2",{attrs:{id:"_2-1-基本原理图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-基本原理图"}},[t._v("#")]),t._v(" 2.1 基本原理图")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/96b5367055a04b8fbbb1e11363883f31~tplv-k3u1fbpfcp-zoom-1.image",alt:"在这里插入图片描述"}}),t._v("\n详细的原理可以看之前在学Vue源码时的关于diff的笔记\n"),a("a",{attrs:{href:"https://blog.csdn.net/weixin_44972008/article/details/115620198",target:"_blank",rel:"noopener noreferrer"}},[t._v("【Vue源码】图解 diff算法 与 虚拟DOM-snabbdom-最小量更新原理解析-手写源码-updateChildren"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"_2-2-关于key的经典面试题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-关于key的经典面试题"}},[t._v("#")]),t._v(" 2.2 关于key的经典面试题")]),t._v(" "),a("ol",[a("li",[t._v("react/vue中的key有什么作用？（key的内部原理是什么？）")]),t._v(" "),a("li",[t._v("为什么遍历列表时，key最好不要用index?")])]),t._v(" "),a("h3",{attrs:{id:"_2-2-1-虚拟dom中key的作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-虚拟dom中key的作用"}},[t._v("#")]),t._v(" 2.2.1 虚拟DOM中key的作用")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("简单的说: key是虚拟DOM对象的标识, 在更新显示时key起着极其重要的作用。")])]),t._v(" "),a("li",[a("p",[t._v("详细的说: 当状态中的数据发生变化时，react会根据【新数据】生成【新的虚拟DOM】, 随后React进行【新虚拟DOM】与【旧虚拟DOM】的diff比较，比较规则如下：")]),t._v(" "),a("ul",[a("li",[t._v("旧虚拟DOM中找到了与新虚拟DOM相同的key：\n"),a("ul",[a("li",[t._v("若虚拟DOM中内容没变, 直接使用之前的真实DOM")]),t._v(" "),a("li",[t._v("若虚拟DOM中内容变了, 则生成新的真实DOM，随后替换掉页面中之前的真实DOM")])])]),t._v(" "),a("li",[t._v("旧虚拟DOM中未找到与新虚拟DOM相同的key\n"),a("ul",[a("li",[t._v("根据数据创建新的真实DOM，随后渲染到到页面")])])])])])]),t._v(" "),a("h3",{attrs:{id:"_2-2-2-用index作为key可能会引发的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-用index作为key可能会引发的问题"}},[t._v("#")]),t._v(" 2.2.2 用index作为key可能会引发的问题")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("若对数据进行：逆序添加、逆序删除等破坏顺序操作: 会产生没有必要的真实DOM更新 ==> 界面效果没问题, 但效率低")])]),t._v(" "),a("li",[a("p",[t._v("如果结构中还包含输入类的DOM：会产生错误DOM更新 ==> 界面有问题")])]),t._v(" "),a("li",[a("p",[t._v("注意！如果不存在对数据的逆序添加、逆序删除等破坏顺序操作，仅用于渲染列表用于展示，使用index作为key是没有问题的")])])]),t._v(" "),a("h3",{attrs:{id:"_2-2-3-开发中如何选择key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-开发中如何选择key"}},[t._v("#")]),t._v(" 2.2.3 开发中如何选择key?")]),t._v(" "),a("ol",[a("li",[t._v("最好使用每条数据的唯一标识作为key, 比如id、手机号、身份证号、学号等唯一值")]),t._v(" "),a("li",[t._v("如果确定只是简单的展示数据，用index也是可以的")])])])}),[],!1,null,null,null);s.default=e.exports}}]);